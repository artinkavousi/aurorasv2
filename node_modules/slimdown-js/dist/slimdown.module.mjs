function n(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=n[e];return r}var t=[],e=[],r=[],l=[],i=[],o={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},u=new RegExp("["+Object.keys(o).join("")+"]","g"),a=function(n){return n.replace(u,function(n){return o[n]})},p=function(n,t){var e=t.trim();return/^<\/?(ul|ol|li|h|p|bl|table|tbody|tr|td|th|caption)/i.test(e)||""===e?"\n"+t+"\n":"\n<p>\n"+e+"\n</p>\n"},c=function(n){if(0===n.length)return"";for(var t="",e=[],r=0;r<n.length;r++){for(var l=n[r],i=r<n.length-1?n[r+1]:null;e.length>0&&e[e.length-1].level>l.level;){var o=e.pop();o.hasOpenLi&&(t+="</li>"),t+="</"+o.type+">"}if(e.length>0&&e[e.length-1].level===l.level&&e[e.length-1].type!==l.type){var u=e.pop();u.hasOpenLi&&(t+="</li>"),t+="</"+u.type+">"}(0===e.length||e[e.length-1].level<l.level)&&(t+="<"+l.type+">",e.push({type:l.type,level:l.level,hasOpenLi:!1})),e.length>0&&e[e.length-1].hasOpenLi&&e[e.length-1].level===l.level&&(t+="</li>",e[e.length-1].hasOpenLi=!1),t+="<li>"+l.content,e[e.length-1].hasOpenLi=!0,(!i||i.level<=l.level)&&(t+="</li>",e[e.length-1].hasOpenLi=!1)}for(;e.length>0;){var a=e.pop();a.hasOpenLi&&(t+="</li>"),t+="</"+a.type+">"}return t},h=function(n,t,e,r){void 0===r&&(r="");for(var l=e.split("|").filter(function(n,t,e){return t>0&&t<e.length-1}).map(function(n){return/:-+:/g.test(n)?"center":/-+:/g.test(n)?"right":/:-+/.test(n)?"left":""}),i=function(n){var t=l[n];return t?' align="'+t+'"':""},o=t.split("|").slice(1,-1),u=o.map(function(n){return n.trim()}),a=[],p=0,c=0;c<u.length;c++)if(p>0)p--;else{var h=u[c];if(h&&h.length){for(var g=1,f=!1,s=c+1;s<u.length&&0===u[s].length;s++)if(""===o[s]){f=!0;break}if(f)for(var v=c+1;v<u.length&&0===u[v].length;v++)g++;g>1?(p=g-1,a.push("<th"+i(c)+' colspan="'+g+'">'+h+"</th>")):a.push("<th"+i(c)+">"+h+"</th>")}else a.push("<th"+i(c)+"></th>")}return"\n<table><tbody><tr>\n  "+a.join("\n  ")+"\n</tr>\n"+r.split("\n").map(function(n){return n.trim()}).filter(function(n){return n&&n.length}).map(function(n){for(var t=n.split("|").slice(1,-1),e=t.map(function(n){return n.trim()}),r=[],l=0,o=0;o<e.length;o++)if(l>0)l--;else{var u=e[o];if(u&&u.length){for(var a=1,p=!1,c=o+1;c<e.length&&0===e[c].length;c++)if(""===t[c]){p=!0;break}if(p)for(var h=o+1;h<e.length&&0===e[h].length;h++)a++;a>1?(l=a-1,r.push("<td"+i(o)+' colspan="'+a+'">'+u+"</td>")):r.push("<td"+i(o)+">"+u+"</td>")}else r.push("<td"+i(o)+"></td>")}return"<tr>\n  "+r.join("\n  ")+"\n</tr>\n"}).join("")+"</tbody></table>\n"},g=[[/\r\n/g,"\n"],[/\n(#+)(.*)/g,function(n,t,e){void 0===e&&(e="");var r=t.length;return"<h"+r+">"+e.trim()+"</h"+r+">"}],[/!\[([^\[]+)\]\((?:javascript:)?([^\)]+)\)/g,'<img src="$2" alt="$1">'],[/\[([^\[]+)\]\((?:javascript:)?([^\)]+)\)/g,'<a href="$2">$1</a>'],[/([^\\])(\*\*|__)(.*?(_|\*)?)\2/g,"$1<strong>$3</strong>"],[/([^\\])(\*|_)(.*?)\2/g,"$1<em>$3</em>"],[/\\_/g,"&#95;"],[/\~\~(.*?)\~\~/g,"<del>$1</del>"],[/\:\"(.*?)\"\:/g,"<q>$1</q>"],[/\n-{3,}/g,"\n<hr />"],[/\n( *)[-*+] \[([xX ])\](.*)/g,function(n,t,e,r){return"\n{{LISTITEM:ul:"+Math.floor(t.length/2)+':<input type="checkbox"'+("x"===e.toLowerCase()?" checked":"")+" disabled> "+r.trim()+"}}\n"}],[/\n( *)(\*|-|\+)(.*)/g,function(n,t,e,r){return"\n{{LISTITEM:ul:"+Math.floor(t.length/2)+":"+r.trim()+"}}\n"}],[/\n( *)([0-9]+\.) (.*)/g,function(n,t,e,r){return"\n{{LISTITEM:ol:"+Math.floor(t.length/2)+":"+r.trim()+"}}\n"}],[/\n(&gt;|\>)(.*)/g,function(n,t,e){return void 0===e&&(e=""),"\n<blockquote>"+e.trim()+"</blockquote>"}],[/(\^)(.*?)\1/g,"<sup>$2</sup>"],[/(\~)(.*?)\1/g,"<sub>$2</sub>"],[/\n\[(.+?)\]\n( *\|[^\n]+\|\r?\n)((?: *\|:?[ -]+:?)+ *\|)(\n(?: *\|[^\n]+\|\r?\n?)*)?/g,function(n,t,e,r,l){return void 0===l&&(l=""),h(0,e,r,l).replace("<table>","<table><caption>"+t.trim()+"</caption>")}],[/( *\|[^\n]+\|\r?\n)((?: *\|:?[ -]+:?)+ *\|)(\n(?: *\|[^\n]+\|\r?\n?)*)?/g,h],[/\[\^([^\]]+)\](?!:)/g,function(n,t){return'<sup id="fnref:'+t+'"><a href="#fn:'+t+'">['+t+"]</a></sup>"}],[/\[\^([^\]]+)\]:\s*((?:[^\n]*\n?)*)/g,function(n,t,e){return i.push([t,e.trim()]),""}],[/\n([A-Z][A-Za-z\s]*?)\s:\s*([A-Z][^\n]*)/g,function(n,t,e){return"\n<dl><dt>"+t.trim()+"</dt><dd>"+e.trim()+"</dd></dl>\n"}]],f=[[/\s?<\/[ou]l>\s?<[ou]l>/g,"",3],[/<\/blockquote>\n<blockquote>/g,"<br>\n"],[/https?:\/\/[^"']*/g,function(n){return n.replace(/<\/?em>/g,"_")}],[/&#95;/g,"_"]],s=function(o,u,h){return void 0===u&&(u=!1),void 0===h&&(h=!1),t.length=0,e.length=0,r.length=0,l.length=0,i.length=0,o=function(n){return n.replace(/\$([^$\n]+)\$/g,function(n,t){return l.push(t),"{{INLINEMATHPH"+(l.length-1)+"}}"})}(o=function(n){return n.replace(/`([^`]+)`/g,function(n,t){return e.push(t),"{{INLINECODEPH"+(e.length-1)+"}}"})}(o=function(n){return n.replace(/\n\s*\$\$([^]*?)\$\$\s*\n/g,function(n,t){return r.push(t.trim()),"\n{{MATHBLOCKPH"+(r.length-1)+"}}\n"})}(o=function(n){return n.replace(/\n\s*```\w*\n([^]*?)\n\s*```\s*\n/g,function(n,e){return t.push(e),"\n<pre>{{CODEBLOCKPH"+(t.length-1)+"}}</pre>\n"})}("\n"+o+"\n")))),g.forEach(function(n){for(var t=n[0],e=n[1],r=n[2],l=void 0===r?1:r,i=0;i<l;i++)o=o.replace(t,e)}),o=(o=function(t){if(!t.includes("{{LISTITEM:"))return t;for(var e,r=[],l=[],i=!1,o=function(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return n(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}(t))){r&&(t=r);var l=0;return function(){return l>=t.length?{done:!0}:{done:!1,value:t[l++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(r=t[Symbol.iterator]()).next.bind(r)}(t.split("\n"));!(e=o()).done;){var u=e.value,a=u.match(/\{\{LISTITEM:([^:]+):([^:]+):(.+)\}\}/);if(a){var p=a[1],h=parseInt(a[2]);if(i&&l.length>0){var g=l[l.length-1];g.type!==p&&g.level===h&&(r.push([].concat(l)),l=[])}l.push({type:p,level:h,content:a[3],originalLine:u}),i=!1}else""!==u.trim()?(l.length>0&&(r.push([].concat(l)),l=[]),i=!1):""===u.trim()&&(i=!0)}if(l.length>0&&r.push(l),0===r.length)return t;for(var f=0,s=r;f<s.length;f++){var v=s[f],d=c(v);t=t.replace(v[0].originalLine,d);for(var m=1;m<v.length;m++)t=t.replace(v[m].originalLine,"")}return t}(o)).replace(/\n([^\n]+)\n/g,p),f.forEach(function(n){for(var t=n[0],e=n[1],r=n[2],l=void 0===r?1:r,i=0;i<l;i++)o=o.replace(t,e)}),o=(o=function(n){return n.replace(/{{INLINEMATHPH(\d+)}}/g,function(n,t){var e=l[parseInt(t)];return'<span class="math-inline">'+a(e)+"</span>"})}(o=function(n){return n.replace(/{{INLINECODEPH(\d+)}}/g,function(n,t){var r=e[parseInt(t)];return"<code>"+a(r)+"</code>"})}(o=function(n){return n.replace(/{{MATHBLOCKPH(\d+)}}/g,function(n,t){var e=r[parseInt(t)];return'<div class="math-block">'+a(e)+"</div>"})}(o=function(n){return n.replace(/<pre>{{CODEBLOCKPH(\d+)}}<\/pre>/g,function(n,e){var r=t[parseInt(e)];return"<pre>"+a(r)+"</pre>"})}(o))))).trim()+(0===i.length?"":'\n<div class="footnotes">\n  <hr>\n  <ol>\n    '+i.map(function(n){var t=n[0];return'\n    <li id="fn:'+t+'">\n      '+n[1]+'\n      <sup><a href="#fnref:'+t+'">â†©</a></sup>\n    </li>'}).join("\n")+"\n  </ol>\n</div>"),u&&(o=o.replace(/^<p>([\s\S]*)<\/p>$/,"$1")),h&&(o=o.replace(/<a href="/g,'<a target="_blank" href="')),o},v=function(n,t){g.push([n,t])};export{v as addRule,s as render};
//# sourceMappingURL=slimdown.module.mjs.map
